# 参数化建模

- 传统方法问题
  - 建模方式不理想
  - 难以有效支持变动设计与系列化设计
- 目标：
  - 支持用户通过草图和几何约束进行精确的几何建模
  - 有效支持用户通过修改几何约束的参数值进行变动设计和系列化产品设计



## 参数化几何模型

- 定义：由一组**形状参数**决定的几何模型
- 几何约束：施加在几何元素之上，对其**形状与位置**进行限定的条件
  - 结构约束：垂直/平行
  - 尺寸约束：距离
  - 代数约束：参数之间满足的代数关系
- 一种参数化几何模型
  - Brep+几何约束
- 参数化几何建模流程
  - 交互构建草图，生成包括拓扑结构的初始形状
  - 交互定义几何结构，生成参数化的几何模型
  - 转为一组参数值，自动生成几何模型所需的精确几何模型
  - 修改特定的参数值，生成变动设计

> 二维很理想
>
> 三维还不行

- 关键技术问题
  - 几何约束系统的有效性判断与修正
    - 几何元素的自由度与约束度：总自由度=总约束度+3
    - 注意过约束与欠约束
  - 约束求解，要求鲁棒高效
  - 多解问题



## 全局约束求解方法 - 变动几何法

- 构建约束方程组
  - 以二维形状的特征点集的坐标为变量构建约束方程
  - 方程组数值求解



## 局部约束求解方法

- 利用几何约束图表达约束关系：以几何元素为结点，以它们之间的约束关系为弧的图
- 方法1：几何推理法
  - 基于几何推理将无向几何约束图转化为有向几何约束图
  - 寻找强连通分枝
  - 对强连通分枝用整体方程组求解，对其他元素局部求解
  - 即从某个节点依次出发，把其他能计算出来（自由度约束度相等）的节点给计算出来
- 方法2：owen图分解算法
  - 对于几何约束图在关键点对处分裂为一系列子图，生成所有可求解的子刚体
  - 求解每个子刚体，再进行拼装，生成整个模型



## 参数化特征建模

- 问题
  - 传统的基本体素不符合设计人员的要求
  - 难以有效支持CAM等下游应用
- 特征feature的定义：零件上具有**特定工程意义**的几何形状
- feature的特性
  - 是三维模型的一个组成部分，必须在模型上有所体现
  - 每类特征对应一类特定的形状，采用参数化表示
  - 语义对象
  - 具有可预测的特性，支持语义推理等智能行为
  - 特征与领域相关
  - 特征数目没有限定
- 特征的表示
  - 属性
    - 特征的Brep
    - 二维草图
    - 定形和定位约束
    - 尺寸参数等参数
    - 非几何属性等
  - 方法
    - 实例化方法
    - 参数继承方法
    - 语义维护方法，避免特征被破坏
    - 特征识别方法
  - 特征模式feature pattern
    - 解决重复表示feature的问题，比如一百个空洞
    - 可以通过一个基本特征和一个由分布规则定义的具有相同形状而仅位置不同的一组特征
  - 特征模型
    - 以特征为结点，以特征之间的关系为弧的图
  - 特征建模方法
    - 特征识别，从Brep中识别出所需的特征
    - 难题一：用户自定义特征
    - 难题二：三维参数化方法，用户给了草图和几何约束，怎么有效求解出参数化方法；基于过程式语言定义特征的参数化表示以及实例化方法
  - 拓扑元素永久命名：怎么给拓扑元素命名，维持一一对应关系
    - 实际使用中，特征可能会增加或者消失，比如圆角可能会因为边出现了槽，从一整个长的圆角边变成了两个圆角短的圆角边



## 基于图的加工特征识别方法

>  [Graph-based heuristics for recognition of machined features from a 3D solid model | Computer-Aided Design (acm.org)](https://dl.acm.org/doi/10.1016/0010-4485(88)90050-4)

- **建模识别特征**
- 属性面邻接图 AFAG
  - 以面为结点，以面之间的相邻关系为弧，以边的凹凸性作为弧的属性的图
  - 凸边：相邻两个面之间**面向体内**的夹角小于180
  - 凹边：相邻两个面之间**面向体内**的夹角大于180
  - 盲槽/通槽/盲台阶：根据凹边来识别
- 方法
  - 构建每类特征的AFAG
  - 构建待识别零件的AFAG
  - 子图匹配：
    - 分解零件的AFAG进行图分解，删除所有凸面（周围所有边都是凸边）
    - 在分解出的子图中进行特征AFAG的子图匹配，识别出加工特征
- 问题
  - 相交特征的识别：难识别，不唯一性
  - 有的特征带凸面，因此通过删除凸面的子图匹配有时不适用





# 发展方向

- 更强
  - 能够有效表示、构建、处理高复杂度的几何模型
  - 集合操作的健壮性
  - 支持真三维参数的建模，现在主要还是通过二维参数约束三维
  - 支持异质实体建模
- 更快
  - 三维CAD模型检索与重用
  - 基于设计历史的快速修改
  - 分布式计算的几何建模算法
- 更方便
  - 基于单位的三维CAD建模
  - 三维交互
  - 保证有效性的直接建模
- 更智能
  - AI+CAD
  - 面向应用需求的智能形状分析与处理
  - 智能重建
  - 特征模型的语义维护